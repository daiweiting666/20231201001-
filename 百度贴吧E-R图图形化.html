<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç™¾åº¦è´´å§E-Rå›¾ - å›¾å½¢åŒ–å±•ç¤º</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            padding: 30px;
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
            background: linear-gradient(45deg, #f093fb, #f5576c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .mermaid {
            text-align: center;
            margin: 20px 0;
            overflow: auto;
        }
        .section {
            margin: 40px 0;
            padding: 20px;
            border-left: 5px solid #f093fb;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .section h2 {
            color: #333;
            margin-top: 0;
        }
        .entity-card {
            display: inline-block;
            margin: 10px;
            padding: 15px;
            background: #fff;
            border: 2px solid #f093fb;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            min-width: 200px;
        }
        .entity-card h3 {
            margin: 0 0 10px 0;
            color: #f5576c;
        }
        .entity-card ul {
            margin: 0;
            padding-left: 20px;
        }
        .entity-card li {
            margin: 5px 0;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—ƒï¸ ç™¾åº¦è´´å§é¡¹ç›®E-Rå›¾</h1>
        
        <div class="section">
            <h2>ğŸ“‹ æ ¸å¿ƒå®ä½“æ¦‚è§ˆ</h2>
            <div style="display: flex; flex-wrap: wrap; justify-content: center;">
                <div class="entity-card">
                    <h3>ğŸ‘¤ ç”¨æˆ·å®ä½“</h3>
                    <ul>
                        <li>user_id (ä¸»é”®)</li>
                        <li>username</li>
                        <li>avatar</li>
                        <li>signature</li>
                        <li>registration_time</li>
                    </ul>
                </div>
                <div class="entity-card">
                    <h3>ğŸ·ï¸ è´´å§å®ä½“</h3>
                    <ul>
                        <li>forum_id (ä¸»é”®)</li>
                        <li>forum_name</li>
                        <li>description</li>
                        <li>creator_id</li>
                        <li>member_count</li>
                    </ul>
                </div>
                <div class="entity-card">
                    <h3>ğŸ“ å¸–å­å®ä½“</h3>
                    <ul>
                        <li>post_id (ä¸»é”®)</li>
                        <li>title</li>
                        <li>content</li>
                        <li>author_id</li>
                        <li>forum_id</li>
                    </ul>
                </div>
                <div class="entity-card">
                    <h3>ğŸ’¬ è¯„è®ºå®ä½“</h3>
                    <ul>
                        <li>comment_id (ä¸»é”®)</li>
                        <li>content</li>
                        <li>author_id</li>
                        <li>post_id</li>
                        <li>parent_id</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>ğŸ”— å®Œæ•´å®ä½“å…³ç³»å›¾</h2>
            <div class="mermaid">
erDiagram
    %% ç”¨æˆ·å®ä½“
    USER {
        int user_id PK "ç”¨æˆ·ID"
        string username "ç”¨æˆ·å"
        string password "å¯†ç "
        string email "é‚®ç®±"
        string avatar "å¤´åƒ"
        string signature "ç­¾å"
        timestamp registration_time "æ³¨å†Œæ—¶é—´"
        timestamp last_login_time "æœ€åç™»å½•"
        enum status "çŠ¶æ€"
    }
    
    %% è´´å§å®ä½“
    FORUM {
        int forum_id PK "è´´å§ID"
        string forum_name "è´´å§åç§°"
        text description "æè¿°"
        int creator_id FK "åˆ›å»ºè€…ID"
        timestamp create_time "åˆ›å»ºæ—¶é—´"
        int member_count "æˆå‘˜æ•°"
        int post_count "å¸–å­æ•°"
        enum status "çŠ¶æ€"
    }
    
    %% å¸–å­å®ä½“
    POST {
        int post_id PK "å¸–å­ID"
        string title "æ ‡é¢˜"
        text content "å†…å®¹"
        int author_id FK "ä½œè€…ID"
        int forum_id FK "è´´å§ID"
        timestamp create_time "å‘å¸ƒæ—¶é—´"
        timestamp update_time "æ›´æ–°æ—¶é—´"
        int view_count "æµè§ˆæ•°"
        int reply_count "å›å¤æ•°"
        int like_count "ç‚¹èµæ•°"
        enum status "çŠ¶æ€"
        boolean is_top "æ˜¯å¦ç½®é¡¶"
    }
    
    %% è¯„è®ºå®ä½“
    COMMENT {
        int comment_id PK "è¯„è®ºID"
        text content "å†…å®¹"
        int author_id FK "ä½œè€…ID"
        int post_id FK "å¸–å­ID"
        int parent_id FK "çˆ¶è¯„è®ºID"
        timestamp create_time "è¯„è®ºæ—¶é—´"
        int like_count "ç‚¹èµæ•°"
        int reply_count "å›å¤æ•°"
        enum status "çŠ¶æ€"
    }
    
    %% ç‚¹èµå®ä½“
    LIKE {
        int user_id FK "ç”¨æˆ·ID"
        int target_id "ç›®æ ‡ID"
        enum target_type "ç›®æ ‡ç±»å‹"
        timestamp create_time "ç‚¹èµæ—¶é—´"
    }
    
    %% æ”¶è—å®ä½“
    FAVORITE {
        int user_id FK "ç”¨æˆ·ID"
        int post_id FK "å¸–å­ID"
        timestamp create_time "æ”¶è—æ—¶é—´"
    }
    
    %% å…³æ³¨å®ä½“
    FOLLOW {
        int follower_id FK "å…³æ³¨è€…ID"
        int followed_id "è¢«å…³æ³¨è€…ID"
        enum follow_type "å…³æ³¨ç±»å‹"
        timestamp create_time "å…³æ³¨æ—¶é—´"
    }
    
    %% æµè§ˆå†å²å®ä½“
    VIEW_HISTORY {
        int user_id FK "ç”¨æˆ·ID"
        int post_id FK "å¸–å­ID"
        timestamp view_time "æµè§ˆæ—¶é—´"
        int duration "æµè§ˆæ—¶é•¿"
    }
    
    %% å®ä½“å…³ç³»å®šä¹‰
    USER ||--o{ POST : "å‘å¸ƒ"
    USER ||--o{ COMMENT : "è¯„è®º"
    USER ||--o{ LIKE : "ç‚¹èµ"
    USER ||--o{ FAVORITE : "æ”¶è—"
    USER ||--o{ FOLLOW : "å…³æ³¨"
    USER ||--o{ VIEW_HISTORY : "æµè§ˆ"
    
    FORUM ||--o{ POST : "åŒ…å«"
    
    POST ||--o{ COMMENT : "æ‹¥æœ‰"
    POST ||--o{ LIKE : "è¢«ç‚¹èµ"
    POST ||--o{ FAVORITE : "è¢«æ”¶è—"
    POST ||--o{ VIEW_HISTORY : "è¢«æµè§ˆ"
    
    COMMENT ||--o{ COMMENT : "å›å¤"
    COMMENT ||--o{ LIKE : "è¢«ç‚¹èµ"
    
    USER ||--o{ USER : "å…³æ³¨"
    USER ||--o{ FORUM : "å…³æ³¨"
            </div>
        </div>
        
        <div class="section">
            <h2>ğŸ“Š å…³ç³»ç±»å‹è¯´æ˜</h2>
            <div class="mermaid">
flowchart TD
    A[å…³ç³»ç±»å‹] --> B[ä¸€å¯¹å¤šå…³ç³»]
    A --> C[å¤šå¯¹å¤šå…³ç³»]
    A --> D[è‡ªå…³è”å…³ç³»]
    
    B --> B1[ç”¨æˆ·-å¸–å­: 1:N]
    B --> B2[è´´å§-å¸–å­: 1:N]
    B --> B3[å¸–å­-è¯„è®º: 1:N]
    
    C --> C1[ç”¨æˆ·-ç”¨æˆ·: N:N]
    C --> C2[ç”¨æˆ·-è´´å§: N:N]
    
    D --> D1[è¯„è®º-è¯„è®º: è‡ªå…³è”]
    D --> D2[ç”¨æˆ·-ç”¨æˆ·: è‡ªå…³è”]
            </div>
        </div>
        
        <div class="section">
            <h2>ğŸ”‘ ä¸»é”®å’Œå¤–é”®å…³ç³»</h2>
            <div class="mermaid">
flowchart LR
    subgraph ä¸»é”®å…³ç³»
        P1[user_id] --> P2[ç”¨æˆ·è¡¨ä¸»é”®]
        P3[forum_id] --> P4[è´´å§è¡¨ä¸»é”®]
        P5[post_id] --> P6[å¸–å­è¡¨ä¸»é”®]
        P7[comment_id] --> P8[è¯„è®ºè¡¨ä¸»é”®]
    end
    
    subgraph å¤–é”®å…³ç³»
        F1[author_id] --> F2[å…³è”ç”¨æˆ·è¡¨]
        F3[forum_id] --> F4[å…³è”è´´å§è¡¨]
        F5[post_id] --> F6[å…³è”å¸–å­è¡¨]
        F7[parent_id] --> F8[å…³è”è¯„è®ºè¡¨]
    end
            </div>
        </div>
    </div>
    
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            er: {
                useMaxWidth: true,
                diagramPadding: 20,
                layoutDirection: 'TB'
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true
            },
            securityLevel: 'loose'
        });
    </script>
</body>
</html>